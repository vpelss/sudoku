

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
  <head><script type="text/javascript" src="/static/js/analytics.js?v=1504952612.0" charset="utf-8"></script>

<script type="text/javascript">archive_analytics.values.service='wb';archive_analytics.values.server_name='wwwb-app22.us.archive.org';archive_analytics.values.server_ms=185;</script><script type="text/javascript" src="/static/js/wbhack.js?v=1504952612.0" charset="utf-8"></script>

<script type="text/javascript">
__wbhack.init('https://web.archive.org/web');
</script>
<link rel="stylesheet" type="text/css" href="/static/css/banner-styles.css?v=1504952612.0" />
<link rel="stylesheet" type="text/css" href="/static/css/iconochive.css?v=1504952612.0" />

<!-- End Wayback Rewrite JS Include -->
    <title>2005/06/02</title>
    <link href="/web/20060512040822cs_/http://www.ecclestoad.co.uk:80/main.css" rel="stylesheet" type="text/css">
    <link rel="alternate" type="application/rss+xml" title="Edmund von der Burg's blog" href="https://web.archive.org/web/20060512040822/http://www.ecclestoad.co.uk/blog/rss.xml"/>

    <link rel="alternate" type="application/rss+xml" title="ecclestoad.co.uk blog" href="https://web.archive.org/web/20060512040822/http://www.ecclestoad.co.uk/blog/rss.xml"/>
  </head>
  <body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/timestamp.js?v=1504952612.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/graph-calc.js?v=1504952612.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/auto-complete.js?v=1504952612.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/toolbar.js?v=1504952612.0" charset="utf-8"></script>

<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
.wb-autocomplete-suggestions {
    text-align: left; cursor: default; border: 1px solid #ccc; border-top: 0; background: #fff; box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute; display: none; z-index: 2147483647; max-height: 254px; overflow: hidden; overflow-y: auto; box-sizing: border-box;
}
.wb-autocomplete-suggestion { position: relative; padding: 0 .6em; line-height: 23px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 1.02em; color: #333; }
.wb-autocomplete-suggestion b { font-weight: bold; }
.wb-autocomplete-suggestion.selected { background: #f0f0f0; }
</style>
<div id="wm-ipp" lang="en" style="display:none;direction:ltr;">
<div style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:130px;padding-top:10px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-5px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" style="text-align:right;">
	<a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://web.archive.org/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/06/02/', '', 'height=400,width=600'); return false;" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=https://web.archive.org/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/06/02/&amp;via=internetarchive', '', 'height=400,width=600'); return false;" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.ecclestoad.co.uk:80/blog/2005/06/02/" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20060512040822" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap">Apr</td>
		  <td class="c" id="displayMonthEl" title="You are here: 04:08:22 May 12, 2006">MAY</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20060620040841/http://www.ecclestoad.co.uk:80/blog/2005/06/02" title="20 Jun 2006"><strong>Jun</strong></a></td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20060426135911/http://www.ecclestoad.co.uk:80/blog/2005/06/02" title="13:59:11 Apr 26, 2006"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;" title="You are here: 04:08:22 May 12, 2006">12</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20060620040841/http://www.ecclestoad.co.uk:80/blog/2005/06/02" title="04:08:41 Jun 20, 2006"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2005</td>
		  <td class="c" id="displayYearEl" title="You are here: 04:08:22 May 12, 2006">2006</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20070608124141/http://www.ecclestoad.co.uk:80/blog/2005/06/02" title="08 Jun 2007"><strong>2007</strong></a></td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20060512040822*/http://www.ecclestoad.co.uk:80/blog/2005/06/02/" title="See a list of every capture for this URL">31 captures</a>
	      <div class="r" title="Timespan for captures of this URL">26 Apr 2006 - 11 Feb 2009</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="550" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn" href="#expand" onclick="__wm.ex(event);return false;"><span class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none;">
            <div style="background-color:#353535;color:#aaa;font-weight:bold;text-align:center;"><a class="wm-selector selected" href="javascript:void(0)">COLLECTED BY</a></div>
    <div style="padding:3px;position:relative;">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexa_ei)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexa_ei" target="_new"><span class="wm-title">Alexa Crawl EI</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Crawl EI from Alexa Internet.  This data is currently not publicly accessible.
	</div>
	      </div>
    </div></div></div></div></div><script type="text/javascript">
__wm.bt(550,27,25,2,"web","http://www.ecclestoad.co.uk:80/blog/2005/06/02/","2006-05-12",1996);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div class="header-wrapper">
  <img src="/web/20060512040822im_/http://www.ecclestoad.co.uk:80/i/eccles_and_toad.gif" alt="Eccles &amp; Toad" align="left">

    <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/">home</a>
~ <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/">blog</a>
~ <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/perl/">perl</a>
~ <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/projects/">projects</a>
~ <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/employ-me/">employ me</a>

  <br>

  You are here: <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/">home</a> &gt; <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog">blog</a> &gt; <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005">2005</a> &gt; <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/06">06</a> &gt; <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/06/02">02</a>
  <br clear="all">

</div>

<div class="google-ads">
<script type="text/javascript"><!--
google_ad_client = "pub-7132662714982338";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text";
google_ad_channel ="";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "999999";
google_color_url = "99CCFF";
google_color_text = "999999";
//--></script>
<script type="text/javascript" src="https://web.archive.org/web/20060512040822js_/http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>


<h1>Blogs 2005/06/02</h1>

(<a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/rss.xml">RSS</a>)



<p>
<b>2005/06/02 - <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/06/02/sudoku_solver_in_three_lines_explained.html">Sudoku solver in three lines explained</a></b><br>
<p>In previous posts I produced a <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/05/25/sudoku_solver_in_four_lines.html">four line
sudoku solver</a> and then went on to <a href="/web/20060512040822/http://www.ecclestoad.co.uk:80/blog/2005/05/27/obfuscation_as_a_learning_tool.html">explain
it</a>. After having watched a C programmer's approach to it I am down
to under three lines. Here it is and how it works.</p>

<pre>
use integer;@A=split//,&lt;&gt;;sub R{for$i(0..80){next if$A[$i];my%t=map{$_/9
==$i/9||$_%9==$i%9||$_/27==$i/27&amp;&amp;$_%9/3==$i%9/3?$A[$_]:0=&gt;1}0..80;R($A[
$i]=$_)for grep{!$t{$_}}1..9;return$A[$i]=0}die@A}R
</pre>

<p>Above the obfu version, below the same code having been fed through
<tt>perltidy</tt>. The code works as before - you feed in the sudoku
grid on one line using zeros for the blanks. The code then spits out
the solution in the same form.</p>

<pre>
use integer;
@A = split //, &lt;&gt;;

sub R {
    for $i ( 0 .. 80 ) {
        next if $A[$i];
        my %t = map {
                 $_ / 9 == $i / 9
              || $_ % 9 == $i % 9
              || $_ / 27 == $i / 27 &amp;&amp; $_ % 9 / 3 == $i % 9 / 3
              ? $A[$_]
              : 0 =&gt; 1
        } 0 .. 80;
        R( $A[$i] = $_ ) for grep { !$t{$_} } 1 .. 9;
        return $A[$i] = 0;
    }
    die @A;
}
R
</pre>

<p>The core difference is that in my four line version I stored the
sudoku grid on a hash, whereas here I use an array. For convenience
here is a sudoku grid where the numbers represent the index in the
array:</p>

<pre>
 0  1  2    3  4  5    6  7  8
 9 10 11   12 13 14   15 16 17
18 19 20   21 22 23   24 25 26

27 28 29   30 31 32   33 34 35
36 37 38   39 40 41   42 43 44
45 46 47   48 49 50   51 52 53

54 55 56   57 58 59   60 61 62
63 64 65   66 67 68   69 70 71
72 73 74   75 76 77   78 79 80
</pre>

<p>I'll now run through the code explaining the various interesting
bits.</p>

<pre>
use integer;
@A = split //, &lt;&gt;;
</pre>

<p>It is rare that obfus use modules but in this case it saved a few
characters. Later on in the code I do a fair amount of integer
mathematics, and without the <tt>use integer</tt> I would have to wrap
up six of the expressions like so: <tt>int( $_ / 9 )</tt>.</p>

<p>The second line puts the grid from STDIN onto an array
<tt>@A</tt>.</p>

<pre>
sub R {
    for $i ( 0 .. 80 ) {
        next if $A[$i];
</pre>

<p>The subroutine <tt>R</tt> is so called because it recurses. The
main part of it is a <tt>for</tt> loop that runs over the whole
grid. However if there is a value in the grid it skips on to the next
position. <tt>$i</tt> is now the current position in the grid that we
are looking to find a value for.</p>

<pre>
        my %t = map {
                 $_ / 9 == $i / 9
              || $_ % 9 == $i % 9
              || $_ / 27 == $i / 27 &amp;&amp; $_ % 9 / 3 == $i % 9 / 3
              ? $A[$_]
              : 0 =&gt; 1
        } 0 .. 80;
</pre>

<p>This is a bit hairy. I am creating a hash <tt>%t</tt> that will
have as its keys the numbers that can not be used in this position, ie
the ones that have been taken. The <tt>map</tt> contains a
<tt>bool_expr ? if_true : if_false</tt> construct to determine what
the key should be.</p>

<p>The first three lines in the <tt>map</tt> are the boolean
expressions to determine if <tt>$_</tt> is in the same row, column or
grid as <tt>$i</tt>. <tt>$_ / 9 == $i / 9</tt> is for the row
(remember that the division is integer so something like 12/9 equals
1). <tt>|| $_ % 9 == $i % 9</tt> is for the column and <tt>|| $_ / 27
== $i / 27 &amp;&amp; $_ % 9 / 3 == $i % 9 / 3</tt> is for the grid (first
part for grid row, second part for grid column). These are quite
straight forward once you've gotten your head round them.</p>

<p>Really the booleans should have brackets round them to clear things
up, however because Perl will stop evaluating them as soon as it finds
one that is true the final <tt>&amp;&amp;</tt> is ok.</p>

<p>Remember that the <tt>map</tt> is assigning a key/value pair to the
hash. Well if these tests return true then the key is <tt>$_</tt>,
otherwise it is <tt>0</tt>. The value is hard coded to true. I was
surprised to find that the code for the key did not need to be in
brackets, evidently the <tt>?:</tt> is more tightly bound than
<tt>=&gt;</tt> which is as you would expect.</p>

<pre>
        R( $A[$i] = $_ ) for grep { !$t{$_} } 1 .. 9;
</pre>

<p>Three things happen here. The <tt>for</tt> loop runs for all the
numbers that can be used in this position thanks to the <tt>grep {
!$t{$_} }</tt> which filters out the numbers that have been used -
they have a true value in the hash <tt>%t</tt>.</p>

<p><tt>R( $A[$i] = $_ )</tt> sets the current position to one of the
possible values and then recurses.</p>

<pre>
        return $A[$i] = 0;
</pre>

<p>If none of the values in the for loop lead to a solution, or if
there were no values to try then we reset the current position to zero
and <tt>return</tt>. This allows other values to be tried in the
'higher' calls to <tt>R</tt>.</p>

<pre>
    }
    die @A;
}
</pre>

<p>If the outermost <tt>for</tt> loop ever reaches the end (ie <tt>$i
== 81</tt>) then we have our solution. Print it out and stop
processing.</p>

<pre>
R
</pre>

<p>The only thing left to do is to actually start running the
code.</p>

<p>So there we are, sudokus solved in three lines of Perl. In my
opinion this is cleaner than my previous offerings as the logic is
tighter. Still this obfu is not as short as it can get. There are two
superfluous semicolons and the logic in the <tt>map</tt> could be
shortened too, as well as some other bits.</p>

</p>



<div class="footer-wrapper">
  &copy; 2005 Eccles &amp; Toad ~
  <a class="grey" href="https://web.archive.org/web/20060512040822/mailto:evdb@ecclestoad.co.uk">evdb@ecclestoad.co.uk</a>
</div>

  </body>
</html>
